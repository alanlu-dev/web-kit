<script setup lang="ts">
import type { GallerySchemaType } from '~/schema/gallery'
import type { NewsSchemaType } from '~/schema/news'

const { data: images } = await useFetch<GallerySchemaType[]>('/api/gallery/é¦–é -å¤§B')
const { data: news } = await useFetch<NewsSchemaType[]>('/api/news/?page_size=4')

const courses = [
  {
    id: 1,
    title: 'åˆç´šå®¶äº‹æ¸…æ½”èª²ç¨‹',
    price: 'NT$3,200',
    tag: '1',
    place: 'å°ä¸­æ½”ç®¡å®¶æ•™å®¤',
    date: '2024/06/01ï½2024/06/30',
    image: '/course1.png',
  },
  {
    id: 2,
    title: 'é€²éšå®¶äº‹æ¸…æ½”èª²ç¨‹',
    price: 'NT$3,200',
    tag: '2',
    place: 'å°ä¸­æ½”ç®¡å®¶æ•™å®¤',
    date: '2024/06/01ï½2024/06/30',
    image: '/course1.png',
  },
  {
    id: 3,
    title: 'åˆç´šå®¶äº‹æ¸…æ½”èª²ç¨‹',
    price: 'NT$3,200',
    tag: '1',
    place: 'å°ä¸­æ½”ç®¡å®¶æ•™å®¤',
    date: '2024/06/01ï½2024/06/30',
    image: '/course1.png',
  },
]
</script>

<template>
  <div>
    <!-- è¼ªæ’­ -->
    <section class="rel {aspect:1440/481;object:cover;w:full}_img aspect:1440/481 bg:footer/.8">
      <ClientOnly>
        <template #fallback>
          <img v-if="images" v-bind="images[0]" />
        </template>
        <Splide :options="{ arrows: false, autoplay: true, interval: 5000, type: 'loop' }">
          <SplideSlide v-for="image in images" :key="image.åœ–ç‰‡">
            <nuxt-link :to="image.å°è½‰é€£çµ || undefined" class="rel">
              <NotionTag :color="image.ç™¼å¸ƒç‹€æ…‹.color" class="abs nowrap p:1x rbl:2x right:0 top:0">{{ image.ç™¼å¸ƒç‹€æ…‹.name }} </NotionTag>
              <img :src="image.åœ–ç‰‡" :alt="image.æ¨™é¡Œ" :title="image.æ¨™é¡Œ" />
            </nuxt-link>
          </SplideSlide>
        </Splide>
      </ClientOnly>
      <span class="abs bg:secondary bottom:0 fg:white p:1x right:0 rtl:2x">1440:481</span>
    </section>

    <!-- æœ€æ–°æ¶ˆæ¯ -->
    <section class="flex flex:column px:7x py:5x py:10x@tablet">
      <h1 class="h1 title">æœ€æ–°æ¶ˆæ¯</h1>
      <div class="center-content inline-flex flex:column flex:row@tablet flex:wrap gap:5x gap:12x|6x@tablet gap:12x|11x@desktop mt:5x mt:8x@tablet mx:auto">
        <nuxt-link v-for="i in news" :key="i.ID" class="~color|300ms|ease bb:1|divider fg:primary-hover:hover flex:1|0|45% max-w:400@tablet max-w:500@desktop" :to="`/news/${i.ID}`">
          <p class="b1-r">{{ i.ç™¼å¸ƒæ—¥æœŸ }}</p>
          <h3 class="b1-r lines:1 my:2x my:3x@tablet">{{ i.æ¨™é¡Œ }}</h3>
        </nuxt-link>
      </div>
      <div class="{mt:7.5x}@tablet mb:1.5x mt:6x text:center">
        <nuxt-link to="/news">
          <Icon icon="material-symbols-light:arrow-right-alt">æ›´å¤šæ¶ˆæ¯</Icon>
        </nuxt-link>
      </div>
    </section>

    <!-- å”æœƒä»‹ç´¹ -->
    <section class="rel {content:'';abs;inset:0;bg:footer/.8}:before background-size:cover background:url(/section2.png)|no-repeat|center|center|fixed px:6x py:5x py:10x@tablet">
      <div class="rel fg:white">
        <h1 class="h1 title fg:inherit!">å”æœƒä»‹ç´¹</h1>
        <div class="f:3.5x f:4.5x@tablet font:regular mt:3x mt:7.5x@tablet text:center">
          <p>ä¸­è¯æ°‘åœ‹è·æ¥­æ¸…æ½”èªè­‰å”æœƒæ˜¯ä¸€å€‹å°ˆæ¥­çµ„ç¹”ï¼Œ</p>
          <p>è‡´åŠ›æ–¼æä¾›æ¸…æ½”è¡Œæ¥­çš„èªè­‰åŠåŸ¹è¨“æœå‹™ï¼Œä¿ƒé€²è¡Œæ¥­ç™¼å±•ã€‚</p>
          <p>æˆ‘å€‘çš„ç›®æ¨™æ˜¯ç¢ºä¿æ¸…æ½”æœå‹™çš„å“è³ªå’Œæ¨™æº–ï¼Œ</p>
          <p>ä¸¦æä¾›å°ˆæ¥­æŒ‡å°ï¼Œä»¥æ”¯æŒæ¸…æ½”å¾æ¥­äººå“¡çš„å°ˆæ¥­æˆé•·å’Œç™¼å±•ã€‚</p>
        </div>
      </div>
    </section>

    <!-- èª²ç¨‹è³‡è¨Š -->
    <section class="flex flex:column py:5x py:10x@tablet">
      <h1 class="h1 title">èª²ç¨‹è³‡è¨Š</h1>
      <section class="rel m:5x|15vw {my:10x}@tablet">
        <ClientOnly>
          <template #fallback>
            <div class="text:center"> loading </div>
          </template>
          <Splide
            :has-track="false"
            :options="{
              arrows: true,
              type: 'loop',
              perPage: 3,
              gap: '28px',
              snap: true,
              pagination: false,
              breakpoints: {
                1024: { perPage: 2 },
                600: { perPage: 1 },
              },
            }"
          >
            <div class="splide__arrows splide__arrows--ltr">
              <Button intent="secondary" class="splide__arrow splide__arrow--prev size:9x left:-2.5em! {size:11.5x!;left:-5em!}@2xs">
                <Icon icon="material-symbols-light:chevron-left" />
              </Button>
              <Button intent="secondary" class="splide__arrow splide__arrow--next size:9x right:-2.5em! {size:11.5x!;right:-5em!}@2xs">
                <Icon icon="material-symbols-light:chevron-right" />
              </Button>
            </div>
            <SplideTrack>
              <SplideSlide v-for="course in courses" :key="course.id" class="px:0.5x pb:0.5x!">
                <div class="text:center">
                  <div class="center-content inline-flex flex:wrap gap:12x|11x mx:auto">
                    <nuxt-link class="bg:base-bg overflow:hidden r:2x scale(1.1):hover_img shadow:md" :to="`/course/${course.id}`">
                      <div class="rel aspect:316/133 overflow:hidden">
                        <img class="abs full ~300ms|ease inset:0 object-fit:cover" :src="course.image" :alt="course.title" />
                      </div>
                      <div class="p:2x|4x">
                        <div class="flex ai:center gap:2x jc:flex-start">
                          <Level :level="course.tag" />
                          <p class="b1-b fg:font-title">{{ course.title }}</p>
                        </div>
                        <div class="flex ai:center jc:flex-start mt:2x">
                          <p class="nowrap">ä¸Šèª²æ—¥æœŸï¼š</p>
                          <p>{{ course.date }}</p>
                        </div>
                        <div class="flex ai:center jc:flex-start mt:2x">
                          <p class="nowrap">ä¸Šèª²åœ°é»ï¼š</p>
                          <p>{{ course.place }}</p>
                        </div>
                        <hr class="bg:#DBD9D9 h:1 mt:9x" />
                        <p class="h3 fg:accent! mt:2x text:right">{{ course.price }}</p>
                      </div>
                    </nuxt-link>
                  </div>
                </div>
              </SplideSlide>
            </SplideTrack>
          </Splide>
        </ClientOnly>
      </section>

      <div class="{mt:7.5x}@tablet mb:1.5x mt:6x text:center">
        <nuxt-link to="/course">
          <Icon icon="material-symbols-light:arrow-right-alt">æ›´å¤šèª²ç¨‹</Icon>
        </nuxt-link>
      </div>
    </section>

    <!-- èª²ç¨‹åƒ¹å€¼ -->
    <section class="flex bg:beryl-10 flex:column px:7x py:5x py:10x@tablet">
      <h1 class="h1 title">èª²ç¨‹åƒ¹å€¼ ğŸš§</h1>
      <div class="b1-r mt:5x mt:10x@tablet text:center">
        <p>TODO</p>
      </div>
    </section>

    <!-- å¯¦ç¸¾æ¡ˆä¾‹ -->
    <section class="flex bg:#F2F9FA flex:column px:7x py:5x py:10x@tablet">
      <h1 class="h1 title">å¯¦ç¸¾æ¡ˆä¾‹ ğŸš§</h1>
      <div class="b1-r mt:5x mt:10x@tablet text:center">
        <p>TODO</p>
      </div>
    </section>

    <!-- è¯çµ¡æˆ‘å€‘ -->
    <section class="flex flex:column px:7x py:5x py:10x@tablet">
      <h1 class="h1 title">è¯çµ¡æˆ‘å€‘ ğŸš§</h1>
      <div class="b1-r mt:5x mt:10x@tablet text:center">
        <p>TODO</p>
      </div>
    </section>
  </div>
</template>
